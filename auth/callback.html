<!DOCTYPE html>
<html>
<head>
    <title>Авторизація...</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.3/dist/umd/supabase.min.js"></script>
    <script>
        const supabaseUrl = 'https://ssdjfcdgxlxcoidpndix.supabase.co';
        const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNzZGpmY2RneGx4Y29pZHBuZGl4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcwMTE1NDYsImV4cCI6MjA3MjU4NzU0Nn0.WHruUEls1-V418FducFudKI38HiPGbuNUyFAj_W-z2o';
        const baseUrl = 'https://zhatrus.github.io/security.app.github.io';
        
        const supabase = window.supabase.createClient(supabaseUrl, supabaseAnonKey);

        async function handleCallback() {
            try {
                // Отримуємо сесію
                const { data: { session }, error } = await supabase.auth.getSession();
                
                if (error) throw error;
                
                if (session) {
                    // Зберігаємо токен в localStorage
                    localStorage.setItem('sb-access-token', session.access_token);
                    localStorage.setItem('sb-refresh-token', session.refresh_token);
                    
                    // Перенаправляємо на головну сторінку
                    window.location.href = `${baseUrl}/index.html`;
                } else {
                    throw new Error('No session');
                }
            } catch (error) {
                console.error('Callback error:', error);
                window.location.href = `${baseUrl}/auth/login.html`;
            }
        }

        // Викликаємо обробку при завантаженні
        window.addEventListener('load', handleCallback);
    </script>
</head>
<body>
    <div style="display: flex; justify-content: center; align-items: center; height: 100vh;">
        <p>Обробка авторизації...</p>
    </div>
</body>
</html>